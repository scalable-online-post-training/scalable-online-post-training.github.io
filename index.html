<!DOCTYPE html>
<html lang="en" class="scroll-smooth">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>UniFACT-VLA | AgiBot Research</title>
    
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        textMain: '#1a1a1a',
                        textMuted: '#4b5563', // Gray-600
                        brand: '#2563eb',
                        bgLight: '#f9fafb', // Gray-50
                    },
                    fontFamily: {
                        sans: ['Inter', 'system-ui', 'sans-serif'],
                        serif: ['Merriweather', 'Georgia', 'serif'],
                        mono: ['JetBrains Mono', 'monospace'],
                    }
                }
            }
        }
    </script>

    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    
    <script src="https://unpkg.com/lucide@latest"></script>
    
    <!-- Updated Fonts: Added weight 800 and 900 for extra boldness -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800;900&family=Merriweather:wght@300;400;700;900&family=JetBrains+Mono:wght@400&display=swap" rel="stylesheet">
    
    <style>
        body { 
            background-color: #ffffff; 
            color: #1a1a1a; 
            font-family: 'Merriweather', serif; 
            line-height: 1.8;
            -webkit-font-smoothing: antialiased;
        }
        
        h1, h2, h3, h4, h5, h6, button, .sans-font, nav {
            font-family: 'Inter', sans-serif;
        }

        /* 2. ENHANCED BOLD TEXT: Global override to make bold text much stronger */
        strong, b, .font-bold {
            font-weight: 800; /* Adjusted: Reduced from 800 (ExtraBold) to 700 (Bold) */
            color: #464444;   /* Adjusted: Changed from #000000 (Pure Black) to #1a1a1a (Soft Black/TextMain) */
        }

        /* Text Shadow for Video Overlays */
        .text-shadow {
            text-shadow: 0 2px 4px rgba(0,0,0,0.9);
        }
        
        .custom-scrollbar::-webkit-scrollbar { width: 4px; height: 4px; }
        .custom-scrollbar::-webkit-scrollbar-track { background: transparent; }
        .custom-scrollbar::-webkit-scrollbar-thumb { background: #d1d5db; border-radius: 2px; }
        .custom-scrollbar::-webkit-scrollbar-thumb:hover { background: #9ca3af; }

        .donut-chart {
            width: 140px; height: 140px; border-radius: 50%;
            background: conic-gradient(
                #22c55e 0% 35%,   /* Home (Green) */
                #f97316 35% 55%,  /* Restaurant (Orange) */
                #3b82f6 55% 75%,  /* Supermarket (Blue) */
                #6b7280 75% 90%,  /* Industrial (Gray) */
                #eab308 90% 100%  /* Office (Yellow) */
            );
            position: relative;
        }
        .donut-hole {
            width: 80px; height: 80px; border-radius: 50%;
            background: #ffffff; position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%);
        }
        
        .academic-table { width: 100%; border-collapse: collapse; font-family: 'Inter', sans-serif; font-size: 0.85rem; }
        .academic-table th { 
            border-bottom: 2px solid #1a1a1a; 
            padding: 12px 8px; 
            font-weight: 800; /* Bolder headers */
            text-align: center; 
            color: #000;
            background-color: #f9fafb;
            white-space: nowrap;
        }
        .academic-table td { 
            border-bottom: 1px solid #e5e7eb; 
            padding: 10px 8px; 
            text-align: center; 
            color: #4b5563; 
        }
        .academic-table tr:last-child td { border-bottom: 2px solid #1a1a1a; }
        .academic-table .row-title { text-align: left; font-weight: 600; color: #1a1a1a; padding-left: 12px; }
        .academic-table .highlight-row { background-color: #eff6ff; }
        .academic-table .highlight-cell { color: #2563eb; font-weight: 800; }
        
        .section-divider { border-bottom: 1px solid #e5e7eb; margin: 4rem 0; }
        .video-card-title {
            background: linear-gradient(to top, rgba(0,0,0,0.8), transparent);
        }
        
        /* Bar Chart Styles */
        .bar-container { display: flex; align-items: flex-end; height: 180px; gap: 16px; }
        .bar-group { flex: 1; display: flex; flex-direction: column; align-items: center; height: 100%; justify-content: flex-end; position: relative; }
        .bar { width: 100%; border-radius: 4px 4px 0 0; position: relative; transition: height 0.5s ease; min-width: 24px; }
        .bar:hover { opacity: 0.9; }
        .bar-label { font-size: 11px; text-align: center; margin-top: 10px; color: #666; font-family: 'Inter', sans-serif; font-weight: 500; line-height: 1.2; }
        .bar-value { position: absolute; top: -24px; width: 100%; text-align: center; font-size: 11px; font-weight: 800; font-family: 'JetBrains Mono', monospace; color: #000; }
        
        /* Step Badge */
        .step-badge {
            width: 36px; height: 36px; 
            border-radius: 50%; 
            background-color: #eff6ff; 
            color: #2563eb; 
            display: flex; 
            align-items: center; 
            justify-content: center; 
            font-family: 'Inter', sans-serif;
            font-weight: 800;
            font-size: 16px;
            flex-shrink: 0;
            border: 1px solid #dbeafe;
        }

        /* X Mark for Table */
        .x-mark { color: #ef4444; font-weight: 800; }
        .check-mark { color: #22c55e; font-weight: 800; }
        
        /* Custom Range Input Style */
        input[type=range]::-webkit-slider-thumb {
            -webkit-appearance: none;
            width: 0;
            height: 0;
        }

        /* Nav Link Hover Effect */
        .nav-link {
            position: relative;
            color: #4b5563;
            text-decoration: none;
            font-weight: 500;
            font-size: 0.95rem; /* Slightly larger for readability */
            transition: color 0.2s;
        }
        .nav-link:hover {
            color: #1a1a1a;
        }
        
        /* AgiBot Logo Fallback Style */
        .logo-fallback {
            font-family: 'Inter', sans-serif;
            font-weight: 900;
            font-style: italic;
            letter-spacing: -1px;
        }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect, useRef } = React;
        
        // --- Icons Wrapper ---
        const IconWrapper = ({ name, size = 24, className }) => {
            const ref = useRef(null);
            useEffect(() => {
                if (!ref.current || !window.lucide) return;
                ref.current.innerHTML = '';
                const i = document.createElement('i');
                i.setAttribute('data-lucide', name);
                i.setAttribute('width', size);
                i.setAttribute('height', size);
                if (className) i.setAttribute('class', className);
                ref.current.appendChild(i);
                window.lucide.createIcons({
                    root: ref.current,
                    nameAttr: 'data-lucide',
                    attrs: { width: size, height: size, class: className }
                });
            }, [name, size, className]);
            return <span ref={ref} className={`inline-flex items-center justify-center ${className || ''}`} style={{ width: size, height: size }}></span>;
        };

        const FileText = (props) => <IconWrapper name="file-text" {...props} />;
        const Github = (props) => <IconWrapper name="github" {...props} />;
        const Database = (props) => <IconWrapper name="database" {...props} />;
        const Target = (props) => <IconWrapper name="target" {...props} />;
        const Volume2 = (props) => <IconWrapper name="volume-2" {...props} />;
        const VolumeX = (props) => <IconWrapper name="volume-x" {...props} />;
        const Info = (props) => <IconWrapper name="info" {...props} />;
        const Bot = (props) => <IconWrapper name="bot" {...props} />;

        // --- Data Constants ---
        const COLORS = {
            perception: '#fbbf24', planning: '#22c55e', mistake: '#60a5fa', collab: '#8b5cf6',
            home: '#22c55e', restaurant: '#f97316', industrial: '#6b7280', supermarket: '#3b82f6', office: '#eab308',
            static: '#86efac', seq: '#f97316', interleaved: '#eab308'
        };

        const SUBTASK_DATA = [
            { name: "Scene Understanding", val: 967, cat: "perception" },
            { name: "Success Detection", val: 800, cat: "planning" },
            { name: "Action Understanding", val: 600, cat: "planning" },
            { name: "Subtask Planning", val: 600, cat: "planning" },
            { name: "Trajectory Understanding", val: 505, cat: "planning" },
            { name: "Task Grounding", val: 486, cat: "perception" },
            { name: "Dualview Matching", val: 445, cat: "perception" },
            { name: "Mistake Existence", val: 334, cat: "mistake" },
            { name: "Task Progress", val: 281, cat: "planning" },
            { name: "Relative Pos. Grounding", val: 249, cat: "perception" },
            { name: "Human-Robot Interaction", val: 227, cat: "collab" },
            { name: "Human Intention", val: 225, cat: "collab" },
            { name: "Mistake Classify", val: 116, cat: "mistake" },
            { name: "Reasoning", val: 112, cat: "planning" },
            { name: "Mistake Recovery", val: 105, cat: "mistake" },
        ];
        
        const MAX_SUBTASK_VAL = 967;

        const DEMO_CATEGORIES = [ 
            { id: 'reasoning', label: 'Embodied Reasoning' }, 
            { id: 'generalization', label: 'Robust Generalization' }, 
            { id: 'instruction', label: 'Instruction Following' }, 
            { id: 'hri', label: 'Human-Robot Interaction' } 
        ];
        
        const DEMO_ITEMS = {
            reasoning: [ 
                { title: "Inner Object Grasping", desc: "Occlusion reasoning", src: "./videos/reasoning_inner.mp4" }, 
                { title: "Shelf Organizing", desc: "Reset misplaced items", src: "./videos/reasoning_error.mp4" } 
            ],
            generalization: [ 
                { title: "Water Bottle", desc: "UserPrompt: I'm thirsty, but I'm trying to lose weight. Please give me a suitable drink.", src: "./videos/gen_water.mp4", src_fpv: "./videos/gen_water_fpv.mp4" }, 
                { title: "Red Pen", desc: "UserPrompt: I want to write, please give me the corresponding items.", src: "./videos/gen_pen.mp4", src_fpv: "./videos/gen_pen_fpv.mp4" }, 
                { title: "White Wadded Paper", desc: "UserPrompt: Pick up desktop trash.", src: "./videos/gen_paper.mp4", src_fpv: "./videos/gen_paper_fpv.mp4" }, 
                { title: "Remote Control", desc: "UserPrompt: I want to watch TV and switch channels. Please provide me the corresponding items.", src: "./videos/gen_remote.mp4", src_fpv: "./videos/gen_remote_fpv.mp4" }, 
                { title: "Charging Cable", desc: "UserPrompt: My phone is out of battery, please give me the corresponding item.", src: "./videos/gen_cable.mp4", src_fpv: "./videos/gen_cable_fpv.mp4" } 
            ],
            instruction: [ 
                { title: "Semantic Understanding", desc: "Step-by-step control enabling precise following of cake details and layer placement.", src: "./videos/instr_cake.mp4" }, 
                { title: "Spatial Understanding", desc: "Precise understanding and targeting of different blocks in various spatial orientations.", src: "./videos/spatial_blocks.mp4" } 
            ],
            hri: [ 
                { title: "Adversarial", desc: "Dynamic Following", src: "./videos/hri_adversarial.mp4" }, 
                { title: "Cooperation", desc: "Human Intention Understanding & Action Interaction", src: "./videos/hri_coop.mp4" } 
            ]
        };

        // --- UI Components ---

        const Navigation = () => {
            const [logoError, setLogoError] = useState(false);

            return (
                <nav className="sticky top-0 z-50 w-full bg-white/80 backdrop-blur-md border-b border-gray-200/50 shadow-sm">
                    <div className="max-w-6xl mx-auto px-6 h-16 flex items-center justify-between">
                        <div className="flex items-center gap-6 h-full">
                            <a href="https://www.agibot.com" target="_blank" className="group h-full flex items-center opacity-90 hover:opacity-100 transition-opacity py-1">
                                {!logoError ? (
                                    <img 
                                        src="./figs/agibot_logo.png" 
                                        alt="AgiBot" 
                                        className="h-9 w-auto object-contain" 
                                        onError={() => setLogoError(true)} 
                                    />
                                ) : (
                                    <div className="flex items-center gap-1.5 text-textMain h-full">
                                        <Bot size={28} className="text-black" />
                                        <span className="logo-fallback text-xl">AgiBot</span>
                                    </div>
                                )}
                            </a>
                            
                            <div className="h-8 w-px bg-gray-300"></div>

                            <a href="#" className="font-bold text-xl tracking-tight text-textMain hover:text-brand transition-colors">
                                UniFACT
                            </a>
                        </div>

                        <div className="flex items-center gap-1 md:gap-8">
                            <div className="hidden md:flex items-center gap-8">
                                <a href="#demos" className="nav-link">Demos</a>
                                <a href="#benchmark" className="nav-link">Benchmark</a>
                                <a href="#methodology" className="nav-link">Methodology</a>
                                <a href="#experiments" className="nav-link">Results</a>
                            </div>
                            
                            <a 
                                href="https://www.agibot.com" 
                                target="_blank" 
                                className="nav-link font-bold text-textMain hover:text-brand transition-colors ml-2"
                            >
                                About Us
                            </a>
                        </div>
                    </div>
                </nav>
            );
        };

        // 4. UPDATED: VideoPlayer with Adaptive Size (No Black Bars)
        const VideoPlayer = ({ src, label, children, className }) => {
            const videoRef = useRef(null);
            const containerRef = useRef(null); 
            
            // PERFORMANCE: Intersection Observer to play/pause videos automatically
            useEffect(() => {
                const video = videoRef.current;
                const container = containerRef.current;
                
                if (!video || !container) return;

                const observer = new IntersectionObserver((entries) => {
                    entries.forEach(entry => {
                        // If video is visible (intersecting)
                        if (entry.isIntersecting) {
                            // Try to auto-play (muted)
                            const playPromise = video.play();
                            if (playPromise !== undefined) {
                                playPromise.catch(error => {
                                    // Auto-play prevented
                                });
                            }
                        } else {
                            // Pause if out of view to save resources
                            video.pause();
                        }
                    });
                }, {
                    threshold: 0.5 // Play when 50% visible
                });

                observer.observe(container);

                return () => {
                    if (container) observer.unobserve(container);
                };
            }, []);

            return (
                <div 
                    ref={containerRef} // Observe this container
                    className={`relative w-full h-full group bg-black overflow-hidden ${className}`} 
                >
                    <video 
                        ref={videoRef}
                        className="w-full h-full object-cover bg-gray-900" 
                        muted
                        loop 
                        playsInline
                        controls  // Native Controls
                        preload="metadata"
                        src={src}
                    />
                    
                    {/* Optional Label in Top-Left (Non-intrusive) */}
                    {label && (
                        <div className="absolute top-2 left-2 px-2 py-1 bg-black/60 text-white text-[10px] font-bold uppercase rounded backdrop-blur-sm border border-white/10 pointer-events-none z-10 text-shadow">
                            {label}
                        </div>
                    )}

                    {/* Description Overlay - retained but ensure it doesn't block controls */}
                    <div className="pointer-events-none z-10">
                        {children}
                    </div>
                </div>
            );
        };

        const Button = ({ icon, label, href="#", colorName }) => {
            const colorMap = {
                red: 'text-red-600 border-red-200 hover:bg-red-600 hover:border-red-600',
                blue: 'text-blue-600 border-blue-200 hover:bg-blue-600 hover:border-blue-600',
                gray: 'text-gray-700 border-gray-200 hover:bg-gray-800 hover:border-gray-800',
                yellow: 'text-yellow-600 border-yellow-200 hover:bg-yellow-500 hover:border-yellow-500',
                green: 'text-green-600 border-green-200 hover:bg-green-600 hover:border-green-600',
            };

            const activeColorClass = colorMap[colorName] || colorMap.gray;

            return (
                <a 
                    href={href} 
                    className={`group flex items-center justify-center gap-2 px-6 py-2 rounded-full border bg-white shadow-sm transition-all duration-300 hover:shadow-lg hover:-translate-y-0.5 hover:text-white ${activeColorClass}`}
                >
                    <span className="group-hover:text-white transition-colors duration-300">
                        {icon}
                    </span>
                    <span className="text-sm font-bold group-hover:text-white transition-colors duration-300">
                        {label}
                    </span>
                </a>
            );
        };

        const SectionHeader = ({ title, subtitle }) => (
            <div className="mb-12 text-center">
                <h2 className="sans-font text-3xl font-bold text-textMain mb-4 tracking-tight">
                    {title}
                </h2>
                {subtitle && <p className="text-textMuted text-lg max-w-4xl mx-auto leading-relaxed font-light">{subtitle}</p>}
            </div>
        );

        const SmartImage = ({ src, alt, className, fallbackText }) => {
            const [isError, setIsError] = useState(false);
            if (isError || !src) {
                return (
                    <div className={`bg-gray-50 border border-gray-200 flex flex-col items-center justify-center text-gray-400 text-sm p-4 ${className}`} style={{minHeight: '200px'}}>
                        <div className="mb-2 opacity-50 text-xs">[Image]</div>
                        {fallbackText || alt}
                    </div>
                );
            }
            return <img src={src} alt={alt} className={className} onError={() => setIsError(true)} />;
        };

        // --- Main App ---

        function App() {
            useEffect(() => {
                if (window.lucide) window.lucide.createIcons();
            });

            // Removed Global Audio State since we use native controls now
            // const [activeVideoId, setActiveVideoId] = useState(null);
            
            // 1. SCROLL REFS: Store refs to scroll containers
            const scrollRefs = useRef({});

            // 1. SCROLL EFFECT: Center 'generalization' on mount
            useEffect(() => {
                const genContainer = scrollRefs.current['generalization'];
                if (genContainer) {
                    // Calculate center position: (Total Width - Viewport Width) / 2
                    // This centers the middle of the scrollable content in the viewport
                    const centerPos = (genContainer.scrollWidth - genContainer.clientWidth) / 2;
                    
                    // Smooth scroll to center
                    genContainer.scrollTo({
                        left: centerPos,
                        behavior: 'smooth' 
                    });
                }
            }, []);

            // const handleToggleAudio = (id) => {
            //     setActiveVideoId(prevId => prevId === id ? null : id);
            // };

            const totalSubtaskSamples = SUBTASK_DATA.reduce((acc, curr) => acc + curr.val, 0);

            // UPDATED: Table Data from LaTeX
            const tableData = [
                {
                    name: "Qwen2.5-VL-3B",
                    vals: [78.49, 37.53, 60.08, 52.61, 65.50, 52.75, 55.67, 46.43, 57.62, 25.98, 86.22, 78.85, 34.43, 73.28, 59.05],
                    avg: 58.64
                },
                {
                    name: "Qwen2.5-VL-7B",
                    vals: [86.66, 50.56, 75.93, 73.09, 76.83, 62.62, 60.67, 54.46, 60.40, 24.20, 73.78, 77.53, 50.30, 72.41, 64.76],
                    avg: 66.69
                },
                {
                    name: "Robo-brain2",
                    vals: [85.73, 57.53, 78.40, 71.08, 82.33, 56.88, 61.00, 51.79, 58.22, 24.56, 84.89, 83.26, 50.90, 76.72, 57.14],
                    avg: 67.38
                },
                {
                    name: "GPT-o4-mini",
                    vals: [88.00, 93.48, 90.12, 73.90, 84.67, 71.63, 65.17, 71.43, 68.91, 49.82, 89.78, 79.74, 66.77, 77.59, 68.57],
                    avg: 77.61
                },
                {
                    name: "Gemini-2.5-pro",
                    vals: [88.42, 89.89, 89.71, 70.68, 89.83, 67.37, 76.67, 81.25, 75.05, 62.28, 91.11, 87.67, 67.07, 90.52, 87.62],
                    avg: 80.55
                },
                {
                    name: "Ours-3B",
                    vals: [84.18, 68.54, 93.21, 77.51, 96.67, 85.25, 90.50, 55.36, 73.86, 51.60, 96.44, 83.26, 75.45, 93.10, 85.71],
                    avg: 82.72,
                    highlight: true
                }
            ];

            return (
                <div className="bg-white min-h-screen">
                    {/* 3. Added Navigation Bar */}
                    <Navigation />
                    
                    <header className="pt-10 pb-16 px-6 max-w-5xl mx-auto text-center border-b border-gray-100">
                        <h1 className="sans-font text-4xl md:text-6xl font-bold text-textMain mb-6 tracking-tighter leading-[1.1]">
                            UniFACT-VLA & AER-bmk
                        </h1>
                        <h2 className="sans-font text-xl md:text-3xl text-textMuted font-light mb-4 max-w-5xl mx-auto leading-normal">
                            Unified Embodied VLM Reasoning with Robotic Action via Auto-regressive Discretized Pre-training
                        </h2>
                        
                        <div className="text-sm md:text-[15px] text-gray-500 max-w-5xl mx-auto mb-10 leading-relaxed font-light text-center">
                            <p>
                                We identify <strong>general reasoning</strong> as critical for robotics. To evaluate it, we introduce <strong>AgiBot Embodied Reasoning (AER)</strong>, the largest and most comprehensive benchmark. Our pretrained UniFACT-VLA unifies reasoning and action via a novel discrete action tokenizer, achieving state-of-the-art instruction following and real-world generalization.
                            </p>
                        </div>
                        
                        <div className="sans-font mb-10">
                            <div className="font-medium text-lg text-textMain">AgiBot Team</div>
                            <div className="text-textMuted text-sm mt-1">AgiBot Research</div>
                        </div>

                        <div className="flex justify-center gap-4 flex-wrap mt-8">
                            <Button href="#" label="Arxiv" colorName="red" icon={<FileText size={18} />} />
                            <Button href="#benchmark" label="Benchmark" colorName="blue" icon={<Target size={18} />} />
                            <Button href="#" label="GitHub" colorName="gray" icon={<Github size={18} />} />
                            <Button href="#" label="HuggingFace" colorName="yellow" icon={<Database size={18} />} />
                        </div>
                    </header>

                    <div className="max-w-5xl mx-auto px-6 mb-12 mt-12">
                        <div className="relative bg-white rounded-lg overflow-hidden shadow-xl border border-gray-200 group">
                             <SmartImage src="./figs/fig1_vis.png" alt="Main Teaser Figure" className="w-full h-auto" fallbackText="[Figure 1: Visualization]" />
                        </div>
                    </div>

                    {/* Videos */}
                    <section id="demos" className="max-w-7xl mx-auto px-6 mb-20 scroll-mt-20">
                        {DEMO_CATEGORIES.map(cat => (
                            <div key={cat.id} className="mb-12">
                                <h4 className="sans-font font-bold text-sm md:text-base uppercase text-gray-500 tracking-wider mb-6 border-b border-gray-100 pb-2 text-center">
                                    {cat.label}
                                </h4>
                                <div 
                                    /* 1. Added ref to the specific container */
                                    ref={el => scrollRefs.current[cat.id] = el}
                                    className={`flex overflow-x-auto gap-6 pb-4 snap-x snap-mandatory custom-scrollbar pl-2 ${DEMO_ITEMS[cat.id]?.length > 2 ? '' : 'md:justify-center'}`}
                                >
                                    {DEMO_ITEMS[cat.id]?.map((item, idx) => {
                                        const baseId = `${cat.id}-${idx}`;

                                        if (cat.id === 'generalization') {
                                            return (
                                                <div key={idx} className="flex-none w-[85vw] md:w-[45%] snap-center">
                                                    <div className="group relative aspect-[32/27] bg-black rounded-lg overflow-hidden border border-gray-200 shadow-sm hover:shadow-md transition-shadow grid grid-rows-2">
                                                        <div className="relative border-b border-white/10 overflow-hidden">
                                                            <VideoPlayer 
                                                                src={item.src} 
                                                            />
                                                        </div>
                                                        <div className="relative overflow-hidden">
                                                            <VideoPlayer 
                                                                src={item.src_fpv || item.src} 
                                                            >
                                                                <div className="absolute bottom-0 left-0 right-0 p-4 bg-gradient-to-t from-black/90 via-black/50 to-transparent pointer-events-none flex flex-col items-center justify-end text-center">
                                                                    <h5 className="!text-white text-sm font-bold sans-font text-shadow leading-tight mb-1">{item.title}</h5>
                                                                    <p className="!text-white text-[11px] leading-snug opacity-100 text-shadow">{item.desc}</p>
                                                                </div>
                                                            </VideoPlayer>
                                                        </div>
                                                    </div>
                                                </div>
                                            );
                                        }
                                        return (
                                            <div key={idx} className="flex-none w-[85vw] md:w-[45%] snap-center">
                                                <div className="group relative aspect-video bg-black rounded-lg overflow-hidden border border-gray-200 shadow-sm hover:shadow-md transition-shadow">
                                                    <VideoPlayer 
                                                        src={item.src}
                                                    >
                                                        <div className="absolute bottom-0 left-0 right-0 p-4 bg-gradient-to-t from-black/90 via-black/50 to-transparent pointer-events-none flex flex-col items-center justify-end text-center">
                                                            <h5 className="!text-white text-sm font-bold sans-font text-shadow leading-tight">{item.title}</h5>
                                                            <p className="!text-white text-xs mt-1 text-shadow opacity-90">{item.desc}</p>
                                                        </div>
                                                    </VideoPlayer>
                                                </div>
                                            </div>
                                        );
                                    })}
                                </div>
                            </div>
                        ))}
                    </section>

                    <div className="section-divider max-w-5xl mx-auto"></div>

                    {/* AER Benchmark Section */}
                    <section id="benchmark" className="max-w-7xl mx-auto px-6 mb-24 scroll-mt-20">
                        <SectionHeader 
                            title="AgiBot Embodied Reasoning (AER) Benchmark" 
                        />
                        
                        <div className="grid md:grid-cols-2 gap-10 mb-12 text-gray-600 leading-relaxed text-sm md:text-base text-justify">
                            <div>
                                <h4 className="sans-font font-bold text-textMain mb-3">Design Motivation</h4>
                                <p className="mb-4">
                                    We posit that advancing <strong>embodied reasoning</strong> is pivotal for achieving generalization and robustness in unstructured environments. Unlike traditional simulation-based VLA evaluations, AER is designed to <strong>decouple and quantify</strong> task-specific reasoning capabilities, measuring the abstract cognition essential for generalization. By establishing this embodied intelligence evaluation suite, we can rigorously assess the abstract reasoning proficiency of pretrained models. This approach facilitates the optimization of multi-stage training and transforms the iterative development of VLAs into a more controllable and guided process.
                                </p>
                            </div>
                            <div>
                                <h4 className="sans-font font-bold text-textMain mb-3">Design Principles</h4>
                                <p className="mb-4">
                                    AER employs a <strong>standardized Visual Question Answering (VQA) protocol</strong> (multiple-choice or binary) to ensure deterministic, rule-based evaluation, eliminating the ambiguity of open-ended generation metrics.
                                </p>
                                <p>
                                    The framework assesses four pillars of embodied intelligence: <strong>(1) Spatial Perception, (2) Task Planning, (3) Mistake Recovery, and (4) Human–Robot Collaboration</strong>. Spanning 15 fine-grained sub-tasks and over 100 scenarios, it tests multi-modal reasoning across static, sequential, and interleaved image-text contexts.
                                </p>
                            </div>
                        </div>

                        <div className="mb-12">
                             <SmartImage src="./figs/aer_benchmark_visualization.png" alt="AER Visualization" className="w-full h-auto rounded-lg border border-gray-200 shadow-sm" fallbackText="[Figure 2: AER Benchmark Overview]" />
                        </div>

                        <div className="bg-white border border-gray-200 rounded-xl shadow-sm overflow-hidden">
                            <div className="grid lg:grid-cols-[30%_25%_45%] divide-y lg:divide-y-0 lg:divide-x divide-gray-100">
                                <div className="p-8 flex flex-col items-center justify-center bg-bgLight">
                                    <h4 className="sans-font font-bold text-xs uppercase tracking-widest text-gray-500 mb-8">Scene Distribution</h4>
                                    <div className="flex items-center gap-8">
                                        <div className="donut-chart shadow-inner"><div className="donut-hole shadow-sm"></div></div>
                                        <div className="text-xs space-y-2 sans-font text-gray-600">
                                            <div className="flex items-center gap-2"><span className="w-2 h-2 rounded-full" style={{background: COLORS.home}}></span> Home (35%)</div>
                                            <div className="flex items-center gap-2"><span className="w-2 h-2 rounded-full" style={{background: COLORS.restaurant}}></span> Restaurant (20%)</div>
                                            <div className="flex items-center gap-2"><span className="w-2 h-2 rounded-full" style={{background: COLORS.supermarket}}></span> Supermarket (20%)</div>
                                            <div className="flex items-center gap-2"><span className="w-2 h-2 rounded-full" style={{background: COLORS.industrial}}></span> Industrial (15%)</div>
                                            <div className="flex items-center gap-2"><span className="w-2 h-2 rounded-full" style={{background: COLORS.office}}></span> Office (10%)</div>
                                        </div>
                                    </div>
                                </div>

                                <div className="p-8 flex flex-col items-center justify-center">
                                    <h4 className="sans-font font-bold text-xs uppercase tracking-widest text-gray-500 mb-8">Vision Source</h4>
                                    <div className="flex h-48 gap-6 w-full max-w-[240px]">
                                        {[
                                            { h: '100%', label: 'Static', val: '52.9%', pct: 0.52875, c: COLORS.static }, 
                                            { h: '50.2%', label: 'Sequential', val: '26.6%', pct: 0.26553, c: COLORS.seq }, 
                                            { h: '38.9%', label: 'Interleaved', val: '20.6%', pct: 0.20572, c: COLORS.interleaved }
                                        ].map((bar, i) => {
                                            const rawCount = totalSubtaskSamples * bar.pct;
                                            const kValue = (rawCount / 1000).toFixed(1).replace(/\.0$/, ''); 
                                            const displayCount = `~${kValue}k`;
                                            return (
                                                <div key={i} className="flex flex-col items-center justify-end gap-2 flex-1 group w-12 h-full cursor-pointer relative">
                                                    <div className="h-6 relative w-full flex justify-center items-end">
                                                        <span className="text-[10px] text-gray-400 font-mono transition-all duration-200 absolute group-hover:opacity-0 translate-y-0 group-hover:-translate-y-1">{bar.val}</span>
                                                        <span className="text-[10px] text-blue-600 font-bold font-mono transition-all duration-200 absolute opacity-0 translate-y-1 group-hover:opacity-100 group-hover:translate-y-0">{displayCount}</span>
                                                    </div>
                                                    <div className="w-full rounded-t-sm transition-all duration-300 hover:opacity-90 hover:scale-y-105 origin-bottom" style={{height: bar.h, backgroundColor: bar.c}}></div>
                                                    <span className="text-[10px] text-gray-500 font-medium sans-font">{bar.label}</span>
                                                </div>
                                            );
                                        })}
                                    </div>
                                </div>

                                <div className="p-8 bg-bgLight">
                                    <h4 className="sans-font font-bold text-xs uppercase tracking-widest text-gray-500 mb-6 text-center">15 Diagnostic Tasks</h4>
                                    <div className="overflow-y-auto h-[240px] pr-4 custom-scrollbar space-y-3">
                                        {SUBTASK_DATA.map((task, idx) => (
                                            <div key={idx} className="flex items-center gap-3 text-xs sans-font group">
                                                <span className="w-36 text-right font-medium text-gray-600 truncate" title={task.name}>{task.name}</span>
                                                <div className="flex-1 h-2 bg-white border border-gray-200 rounded-full overflow-hidden">
                                                    <div className="h-full rounded-full transition-all duration-500" style={{width: `${(task.val/MAX_SUBTASK_VAL)*100}%`, background: COLORS[task.cat]}}></div>
                                                </div>
                                                <span className="w-8 text-right text-gray-400 font-mono text-[10px]">{task.val}</span>
                                            </div>
                                        ))}
                                    </div>
                                </div>
                            </div>
                        </div>
                    </section>

                    <div className="section-divider max-w-5xl mx-auto"></div>

                    {/* Methodology Section */}
                    <section id="methodology" className="max-w-6xl mx-auto px-6 mb-24 scroll-mt-20">
                        <SectionHeader 
                            title="Methodology: UniFACT-VLA" 
                            subtitle="Aligning Reasoning and Action in a Shared Space"
                        />
                        
                        <div className="mb-20">
                            <div className="bg-white border border-gray-200 rounded-xl p-2 mb-8 shadow-sm">
                                <SmartImage src="./figs/fig_framework.png" alt="UniFACT Framework" className="w-full h-auto rounded-lg" fallbackText="[Figure: Framework]" />
                            </div>
                            
                            <div className="max-w-4xl mx-auto text-justify text-gray-600 space-y-6">
                                <p>
                                    Possessing a VLM with robust embodied reasoning is only half the equation; seamlessly translating this reasoning into high-precision control without losing generalizability presents a distinct hurdle.
                                </p>
                                <p>
                                    Current VLA systems often suffer from a "split brain" problem. They attach continuous diffusion heads to discrete VLMs, creating <strong>gradient interference</strong> that damages the model's reasoning capabilities during training.
                                </p>
                                <p>
                                    We introduce <strong>UniFACT-VLA</strong>, a unified architecture that treats physical action not as a separate regression task, but as a "foreign language" for the VLM.
                                </p>
                                <p>
                                    By discretizing robot actions into tokens, we align the action space with the reasoning space. This enables the model to be optimized with a single auto-regressive objective—allowing high-level <strong>Embodied Reasoning</strong> to flow seamlessly into low-level control without conflict.
                                </p>
                            </div>
                        </div>

                        <div className="bg-white rounded-2xl p-8 border border-gray-200 shadow-sm">
                            <h3 className="sans-font text-3xl font-bold mb-6 flex items-center justify-center gap-3 border-b border-gray-100 pb-6 text-center">
                                UniFACT: Bridging Discrete Thought & Continuous Action
                            </h3>
                            
                            <p className="text-gray-600 leading-relaxed mb-10 text-lg w-full text-center">
                                UniFACT encodes continuous actions into discrete tokens to align with the VLM, utilizing Flow Matching to reconstruct high-fidelity trajectories from the quantized representation.
                            </p>
                            
                            <div className="flex flex-col lg:flex-row gap-12 items-center">
                                <div className="w-full lg:w-3/5">
                                    <div className="bg-white border border-gray-200 rounded-xl p-2 shadow-sm">
                                        <SmartImage src="./figs/fig_tokenizer.png" alt="Tokenizer" className="w-full h-auto rounded-lg" fallbackText="[Figure: Tokenizer]" />
                                    </div>
                                </div>
                                <div className="w-full lg:w-2/5 space-y-8 text-justify lg:text-left">
                                    <div className="border-l-4 border-brand pl-6 py-2">
                                        <h4 className="sans-font font-bold text-lg text-textMain mb-2">VQ-Encoder</h4>
                                        <p className="text-sm text-textMuted leading-relaxed">
                                            Built on the MM-DiT architecture, it compresses continuous action chunks into <strong>compact discrete tokens</strong>. This transforms complex physical dynamics into a unified vocabulary compatible with the VLM.
                                        </p>
                                    </div>
                                    
                                    <div className="border-l-4 border-purple-500 pl-6 py-2">
                                        <h4 className="sans-font font-bold text-lg text-textMain mb-2">Flow-Matching Decoder</h4>
                                        <p className="text-sm text-textMuted leading-relaxed">
                                            Leveraging an MM-DiT backbone, it utilizes <strong>Flow Matching</strong> to reconstruct high-fidelity trajectories from discrete tokens. This design ensures smooth, precise motion recovery despite the discrete bottleneck.
                                        </p>
                                    </div>
                                </div>
                            </div>
                            
                            <div className="grid md:grid-cols-2 gap-8 items-center bg-white border border-gray-200 rounded-xl p-8 mt-12">
                                <div className="text-justify md:text-left">
                                    <h4 className="sans-font font-bold text-xl mb-6 text-textMain">Why it works better?</h4>
                                    <ul className="space-y-6 inline-block text-left">
                                        <li className="flex gap-4">
                                            <div>
                                                <strong className="block text-sm font-semibold text-gray-900 mb-1">High Fidelity</strong>
                                                <span className="text-sm text-textMuted">UniFACT achieves an <strong>order-of-magnitude lower MSE</strong> than FAST+ and significantly smaller tokens than simple binning. Its MM-DiT Flow-Matching decoder eliminates quantization artifacts, reconstructing smooth, continuous trajectories to ensure sub-millimeter precision.</span>
                                            </div>
                                        </li>
                                        <li className="flex gap-4">
                                            <div>
                                                <strong className="block text-sm font-semibold text-gray-900 mb-1">Unified Space</strong>
                                                <span className="text-sm text-textMuted">Resolves the <strong>gradient interference</strong> that plagues hybrid architectures. By treating actions as discrete tokens, UniFACT aligns the motor control space with the VLM's reasoning space, allowing both to be co-optimized within a <strong>shared gradient space</strong>.</span>
                                            </div>
                                        </li>
                                    </ul>
                                </div>
                                <div className="flex justify-center">
                                    <div className="w-full max-w-sm">
                                        <SmartImage src="./figs/fig_exp_tokenizer.png" className="w-full h-auto mt-4" fallbackText="[Chart: MSE Comparison]" />
                                        <p className="text-center text-xs text-gray-400 mt-2">Reconstruction Error Analysis (Log Scale)</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </section>

                    <div className="section-divider max-w-5xl mx-auto"></div>

                    {/* Experimental Results */}
                    <section id="experiments" className="max-w-6xl mx-auto px-6 mb-24 scroll-mt-20">
                        <SectionHeader title="Experiment Results" />

                        {/* Step 1: The Brain */}
                        <div className="mb-24 scroll-mt-24" id="exp-brain">
                            <div className="flex items-center justify-center gap-4 mb-6">
                                <span className="step-badge">1</span>
                                <h3 className="sans-font text-2xl font-bold text-textMain flex items-center gap-2">
                                    High-Level: SOTA Embodied Reasoning
                                </h3>
                            </div>
                            <div className="mb-8 max-w-4xl mx-auto text-justify">
                                <p className="text-gray-600 mb-6">
                                    We first evaluate the reasoning ability of our pretrained model. On the AER benchmark, UniFACT-ER significantly outperforms baselines including close-sourced Gemini and GPT.
                                </p>
                            </div>
                            <div className="overflow-x-auto border border-gray-200 rounded-lg shadow-sm">
                                <table className="academic-table min-w-[1000px]">
                                    <thead><tr><th className="sticky left-0 bg-gray-50 z-10 text-left pl-4">Model</th><th>Scene</th><th>Dual</th><th>Task</th><th>Rel.Pos</th><th>Action</th><th>Success</th><th>Subtask</th><th>Reason</th><th>Traj</th><th>Progress</th><th>Intention</th><th>Interact</th><th>Mistake</th><th>Classify</th><th>Recover</th><th className="sticky right-0 bg-blue-50 text-blue-700 z-10 border-l border-blue-100">Avg</th></tr></thead>
                                    <tbody>
                                        {tableData.map((row, i) => (
                                            <tr key={i} className={row.highlight ? "highlight-row" : "hover:bg-gray-50"}><td className={`row-title sticky left-0 z-10 ${row.highlight ? 'bg-blue-50' : 'bg-white'}`}>{row.name}</td>{row.vals.map((v, j) => <td key={j}>{v}</td>)}<td className={`sticky right-0 z-10 font-bold border-l border-blue-100 ${row.highlight ? 'highlight-cell bg-blue-100' : 'bg-blue-50'}`}>{row.avg}</td></tr>
                                        ))}
                                    </tbody>
                                </table>
                            </div>
                        </div>

                        {/* Step 2: Correlation (Updated Table) */}
                        <div className="mb-24 scroll-mt-24" id="exp-corr">
                            <div className="flex items-center justify-center gap-4 mb-6">
                                <span className="step-badge">2</span>
                                <h3 className="sans-font text-2xl font-bold text-textMain flex items-center gap-2">
                                    The Correlation: Smarter Reasoning = Better Action?
                                </h3>
                            </div>
                            
                            <div className="mb-8 max-w-4xl mx-auto text-justify">
                                <p className="text-gray-600 mb-6">
                                    We conducted a controlled ablation study to verify if stronger reasoning translates to better execution. The results show a clear <strong>positive correlation</strong>: improving the VLM's AER score (Reasoning) directly drives End-to-End Success Rate (Action).
                                </p>
                            </div>
                            
                            <div className="overflow-x-auto border border-gray-200 rounded-lg shadow-sm">
                                <table className="academic-table w-full text-xs md:text-sm">
                                    <thead>
                                        <tr>
                                            <th className="bg-gray-50" rowSpan="2">Exp#</th>
                                            <th className="bg-gray-50" rowSpan="2">Base</th>
                                            <th className="bg-gray-100" colSpan="2">Pre-train</th>
                                            <th className="bg-gray-50" rowSpan="2">Post-train</th>
                                            <th className="bg-gray-50" rowSpan="2">AER</th>
                                            <th className="bg-blue-50 text-blue-700" colSpan="3">Language Following ↑</th>
                                            <th className="bg-green-50 text-green-700" colSpan="3">Success Rate ↑</th>
                                        </tr>
                                        <tr className="border-b-2 border-gray-800">
                                            <th className="bg-gray-100 border-b-2 border-gray-300">Stage1</th>
                                            <th className="bg-gray-100 border-b-2 border-gray-300">Stage2</th>
                                            <th className="bg-blue-50 border-b-2 border-blue-200">Target</th>
                                            <th className="bg-blue-50 border-b-2 border-blue-200">Abs Pose</th>
                                            <th className="bg-blue-50 border-b-2 border-blue-200">Color</th>
                                            <th className="bg-green-50 border-b-2 border-green-200">Target</th>
                                            <th className="bg-green-50 border-b-2 border-green-200">Abs Pose</th>
                                            <th className="bg-green-50 border-b-2 border-green-200">Color</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr className="hover:bg-gray-50">
                                            <td className="font-semibold text-gray-800">Exp1</td>
                                            <td>Qwen</td>
                                            <td className="text-center"><span className="x-mark">✗</span></td>
                                            <td className="text-center"><span className="x-mark">✗</span></td>
                                            <td>Action Only</td>
                                            <td className="text-center">58.64</td>
                                            <td className="text-center">0.24</td>
                                            <td className="text-center">0.05</td>
                                            <td className="text-center">0.17</td>
                                            <td className="text-center">0.05</td>
                                            <td className="text-center">0.00</td>
                                            <td className="text-center">0.06</td>
                                        </tr>
                                        <tr className="hover:bg-gray-50 border-t border-gray-100">
                                            <td className="font-semibold text-gray-800">Exp2</td>
                                            <td>Qwen</td>
                                            <td className="text-center"><span className="x-mark">✗</span></td>
                                            <td className="text-center font-medium">Action</td>
                                            <td>Action Only</td>
                                            <td className="text-center">58.64</td>
                                            <td className="text-center">0.57</td>
                                            <td className="text-center">0.45</td>
                                            <td className="text-center">0.52</td>
                                            <td className="text-center">0.12</td>
                                            <td className="text-center">0.20</td>
                                            <td className="text-center">0.07</td>
                                        </tr>
                                        <tr className="hover:bg-gray-50 border-t border-gray-100">
                                            <td className="font-semibold text-gray-800">Exp3</td>
                                            <td>Qwen</td>
                                            <td className="text-center font-medium">Embodied Data</td>
                                            <td className="text-center font-medium">Action</td>
                                            <td>Action Only</td>
                                            <td className="text-center font-bold text-blue-700">82.72</td>
                                            <td className="text-center">0.78</td>
                                            <td className="text-center font-bold text-blue-600">0.68</td>
                                            <td className="text-center">0.73</td>
                                            <td className="text-center">0.18</td>
                                            <td className="text-center">0.05</td>
                                            <td className="text-center">0.14</td>
                                        </tr>
                                        <tr className="highlight-row border-t-2 border-blue-200 font-medium">
                                            <td className="font-bold text-blue-900">Exp4</td>
                                            <td>Qwen</td>
                                            <td className="text-center">Embodied Data</td>
                                            <td className="text-center">Action</td>
                                            <td className="text-blue-800">Embodied Cotrain</td>
                                            <td className="text-center font-bold text-blue-700">82.72</td>
                                            <td className="text-center font-bold text-blue-600">0.79</td>
                                            <td className="text-center">0.54</td>
                                            <td className="text-center font-bold text-blue-600">0.91</td>
                                            <td className="text-center font-bold text-green-600">0.25</td>
                                            <td className="text-center font-bold text-green-600">0.35</td>
                                            <td className="text-center font-bold text-green-600">0.22</td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>

                        {/* Step 3: The Cerebellum (Tokenizer) */}
                        <div className="mb-24 scroll-mt-24" id="exp-action">
                            <div className="flex items-center justify-center gap-4 mb-6">
                                <span className="step-badge">3</span>
                                <h3 className="sans-font text-2xl font-bold text-textMain flex items-center gap-2">
                                    Low-Level: Discrete token + Continuous reconstruction
                                </h3>
                            </div>
                            <p className="text-gray-600 mb-8 max-w-4xl mx-auto text-justify">
                                We compare our UniFACT-VLA against state-of-the-art <strong>Discrete VLA (FAST+)</strong> and <strong>Continuous VLA (<span className="font-serif italic">π</span><sub>0</sub>, <span className="font-serif italic">π</span><sub>0.5</sub>)</strong> policies in real-world experiments. UniFACT-VLA achieves the SOTA in both high instruction following accuracy (than discrete methods) and high success rates on unseen objects (than continuous methods).
                            </p>
                            
                            <div className="grid md:grid-cols-3 gap-6">
                                <div className="bg-white p-4 rounded-xl border border-gray-200 shadow-sm">
                                    <h5 className="sans-font text-xs font-bold uppercase text-gray-500 mb-4 text-center">Instruction Following</h5>
                                    <SmartImage src="./figs/fig7_language_following.png" alt="Fig 7: Language Following" className="w-full h-auto rounded" fallbackText="[Fig 7: Language Following Chart]" />
                                </div>
                                <div className="bg-white p-4 rounded-xl border border-gray-200 shadow-sm">
                                    <h5 className="sans-font text-xs font-bold uppercase text-gray-500 mb-4 text-center">Success Rate</h5>
                                    <SmartImage src="./figs/fig8_success_rate.png" alt="Fig 8: Success Rate" className="w-full h-auto rounded" fallbackText="[Fig 8: Success Rate Chart]" />
                                </div>
                                <div className="bg-white p-4 rounded-xl border border-gray-200 shadow-sm">
                                    <h5 className="sans-font text-xs font-bold uppercase text-gray-500 mb-4 text-center">Overall Score</h5>
                                    <SmartImage src="./figs/fig9_overall_score.png" alt="Fig 9: Overall Score" className="w-full h-auto rounded" fallbackText="[Fig 9: Overall Performance]" />
                                </div>
                            </div>
                        </div>

                    </section>

                    {/* Footer */}
                    <footer className="bg-bgLight border-t border-gray-200 py-20 px-6">
                        <div className="max-w-5xl mx-auto">
                            <div className="grid md:grid-cols-2 gap-12 mb-12 text-center md:text-left">
                                <div><h4 className="sans-font font-bold text-textMain mb-4">AgiBot Research</h4><p className="text-sm text-gray-600 leading-relaxed max-w-sm mx-auto md:mx-0">Committed to advancing frontier research in embodied artificial intelligence, enabling robots to truly understand and adapt to complex physical worlds.</p></div>
                                <div><h4 className="sans-font font-bold text-textMain mb-4 text-xs uppercase tracking-wide">Citation</h4><div className="bg-white p-4 border border-gray-200 rounded text-xs font-mono text-gray-600 overflow-x-auto select-all shadow-sm text-left">{`@article{agibot2025UniFACT,\n  title={UniFACT-VLA: Unified Embodied VLM Reasoning with Robotic Action via Auto-regressive Discretized Pre-training},\n  author={AgiBot Team},\n  journal={arXiv preprint},\n  year={2025}\n}`}</div></div>
                            </div>
                            <div className="text-center text-xs text-gray-400 sans-font border-t border-gray-200 pt-8">© 2025 AgiBot Research.</div>
                        </div>
                    </footer>
                </div>
            );
        }

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>